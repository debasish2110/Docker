### docker build pf flask app
------------------------------
[ec2-user@ip-172-31-42-60 python_docker]$ ls
Dockerfile  app.py  readme.md  requirements.txt
[ec2-user@ip-172-31-42-60 python_docker]$ vi Dockerfile
[ec2-user@ip-172-31-42-60 python_docker]$ docker build -t flask-app .
[+] Building 28.4s (10/10) FINISHED                                                                                                                                      docker:default
 => [internal] load build definition from Dockerfile                                                                                                                               0.0s
 => => transferring dockerfile: 261B                                                                                                                                               0.0s
 => [internal] load metadata for docker.io/library/python:3.12                                                                                                                     2.3s
 => [auth] library/python:pull token for registry-1.docker.io                                                                                                                      0.0s
 => [internal] load .dockerignore                                                                                                                                                  0.0s
 => => transferring context: 2B                                                                                                                                                    0.0s
 => [internal] load build context                                                                                                                                                  0.0s
 => => transferring context: 3.08kB                                                                                                                                                0.0s
 => [1/4] FROM docker.io/library/python:3.12@sha256:f282c100bbcd0db4346ba7261e15272937fe89de316f0a7159168da02b6fc55e                                                              22.3s
 => => resolve docker.io/library/python:3.12@sha256:f282c100bbcd0db4346ba7261e15272937fe89de316f0a7159168da02b6fc55e                                                               0.0s
 => => sha256:f282c100bbcd0db4346ba7261e15272937fe89de316f0a7159168da02b6fc55e 10.05kB / 10.05kB                                                                                   0.0s
 => => sha256:1062a4ad4794e37369ee0e8752a506d0aa678f43d5c9e981382f091a32c3a395 6.39kB / 6.39kB                                                                                     0.0s
 => => sha256:07d1b5af933d2dfc3d0dd509d6e20534825e4a537f7b006a6cb5b8e5a1f20905 24.01MB / 24.01MB                                                                                   1.2s
 => => sha256:1eb98adba0eb44a2e4facf9ca3626a4a66feedd0dd56d159cca90a35205744e7 64.40MB / 64.40MB                                                                                   2.7s
 => => sha256:687afe1e4711987185478eab5de174479ad52478672a63128b41005323cdb935 2.33kB / 2.33kB                                                                                     0.0s
 => => sha256:23b7d26ef1d294256da0d70ce374277b9aab5ca683015073316005cb63d33849 48.49MB / 48.49MB                                                                                   1.1s
 => => sha256:b617a119f8a27982374d94ec6eb3738ae3d38d6fc2c34c865813926cf596a621 211.33MB / 211.33MB                                                                                 4.6s
 => => extracting sha256:23b7d26ef1d294256da0d70ce374277b9aab5ca683015073316005cb63d33849                                                                                          5.2s
 => => sha256:b8b74aabd4c72add71994bb837da51f058cbb389c1bbe03beebff7d5c04da927 6.16MB / 6.16MB                                                                                     1.9s
 => => sha256:8142f224b5d534d6a57142f725d8f3119a1b767aae9256c2ddcbd8bcc9db4cd2 25.64MB / 25.64MB                                                                                   2.9s
 => => sha256:8c72ffe0dcda8840ed70d09950613f2ea13999540477d73cdad1a0595ed2b691 250B / 250B                                                                                         2.9s
 => => extracting sha256:07d1b5af933d2dfc3d0dd509d6e20534825e4a537f7b006a6cb5b8e5a1f20905                                                                                          0.8s
 => => extracting sha256:1eb98adba0eb44a2e4facf9ca3626a4a66feedd0dd56d159cca90a35205744e7                                                                                          3.3s
 => => extracting sha256:b617a119f8a27982374d94ec6eb3738ae3d38d6fc2c34c865813926cf596a621                                                                                          9.2s
 => => extracting sha256:b8b74aabd4c72add71994bb837da51f058cbb389c1bbe03beebff7d5c04da927                                                                                          0.3s
 => => extracting sha256:8142f224b5d534d6a57142f725d8f3119a1b767aae9256c2ddcbd8bcc9db4cd2                                                                                          1.2s
 => => extracting sha256:8c72ffe0dcda8840ed70d09950613f2ea13999540477d73cdad1a0595ed2b691                                                                                          0.0s
 => [2/4] COPY . /app                                                                                                                                                              0.1s
 => [3/4] WORKDIR /app                                                                                                                                                             0.1s
 => [4/4] RUN pip install -r requirements.txt                                                                                                                                      3.3s
 => exporting to image                                                                                                                                                             0.2s
 => => exporting layers                                                                                                                                                            0.2s
 => => writing image sha256:48f20ef0b7a69661bd203e56bac807117a7bd181cbe86b943a196f44b3e3f30f                                                                                       0.0s
 => => naming to docker.io/library/flask-app      

 ### push image to docker private registry
 -------------------------------------------
 [ec2-user@ip-172-31-42-60 python_docker]$ docker login
Authenticating with existing credentials...
WARNING! Your password will be stored unencrypted in /home/ec2-user/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
[ec2-user@ip-172-31-42-60 python_docker]$ docker images
REPOSITORY      TAG       IMAGE ID       CREATED          SIZE
flask-app       latest    48f20ef0b7a6   2 minutes ago    1.03GB
test            latest    362518b5324c   50 minutes ago   126MB
deba2110/test   latest    362518b5324c   50 minutes ago   126MB
[ec2-user@ip-172-31-42-60 python_docker]$ docker tag flask-app deba2110/flask-app
[ec2-user@ip-172-31-42-60 python_docker]$ docker images
REPOSITORY           TAG       IMAGE ID       CREATED          SIZE
flask-app            latest    48f20ef0b7a6   2 minutes ago    1.03GB
deba2110/flask-app   latest    48f20ef0b7a6   2 minutes ago    1.03GB
test                 latest    362518b5324c   50 minutes ago   126MB
deba2110/test        latest    362518b5324c   50 minutes ago   126MB
[ec2-user@ip-172-31-42-60 python_docker]$ docker push deba2110/flask-app
Using default tag: latest
The push refers to repository [docker.io/deba2110/flask-app]
5573394360b4: Pushed
5f70bf18a086: Pushed
a512b4c86049: Pushed
e9b3f3afe636: Mounted from library/python
09418520a5f8: Mounted from library/python
68405a3b48ff: Mounted from library/python
6c7c1b88da61: Mounted from library/python
b2bcbd8ebb2b: Mounted from library/python
7f0053786e6e: Mounted from library/python
f7f2b929d8a5: Mounted from library/python
latest: digest: sha256:fb5c900b539101ffe356f20994a2aef4cc10ab8d950f69f9e19533ab5741e79b size: 2421
[ec2-user@ip-172-31-42-60 python_docker]$

-----------------------------------------------------------------------------
### push docker image to AWS ECR (login to aws and create a repo in ECR and keep repo name same as the tag name)
-----------------------------------
(below commands we can get by clicking "view push commands" for the repo)
-----------------------------------------------------------------------------

[ec2-user@ip-172-31-42-60 python_docker]$ aws ecr get-login-password --region ap-south-1 | docker login --username AWS --password-stdin 709524548272.dkr.ecr.ap-south-1.amazonaws.com

Unable to locate credentials. You can configure credentials by running "aws configure".
Error: Cannot perform an interactive login from a non TTY device
[ec2-user@ip-172-31-42-60 python_docker]$ aws ecr get-login-password --region ap-south-1 | docker login --username AWS --password-stdin 709524548272.dkr.ecr.ap-south-1.amazonaws.com
WARNING! Your password will be stored unencrypted in /home/ec2-user/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
[ec2-user@ip-172-31-42-60 python_docker]$ docker build -t flask-app .
[+] Building 1.6s (10/10) FINISHED                                                                                                                                       docker:default
 => [internal] load build definition from Dockerfile                                                                                                                               0.0s
 => => transferring dockerfile: 261B                                                                                                                                               0.0s
 => [internal] load metadata for docker.io/library/python:3.12                                                                                                                     1.5s
 => [auth] library/python:pull token for registry-1.docker.io                                                                                                                      0.0s
 => [internal] load .dockerignore                                                                                                                                                  0.0s
 => => transferring context: 2B                                                                                                                                                    0.0s
 => [internal] load build context                                                                                                                                                  0.0s
 => => transferring context: 358B                                                                                                                                                  0.0s
 => [1/4] FROM docker.io/library/python:3.12@sha256:f282c100bbcd0db4346ba7261e15272937fe89de316f0a7159168da02b6fc55e                                                               0.0s
 => CACHED [2/4] COPY . /app                                                                                                                                                       0.0s
 => CACHED [3/4] WORKDIR /app                                                                                                                                                      0.0s
 => CACHED [4/4] RUN pip install -r requirements.txt                                                                                                                               0.0s
 => exporting to image                                                                                                                                                             0.0s
 => => exporting layers                                                                                                                                                            0.0s
 => => writing image sha256:48f20ef0b7a69661bd203e56bac807117a7bd181cbe86b943a196f44b3e3f30f                                                                                       0.0s
 => => naming to docker.io/library/flask-app                                                                                                                                       0.0s
[ec2-user@ip-172-31-42-60 python_docker]$ docker tag flask-app:latest 709524548272.dkr.ecr.ap-south-1.amazonaws.com/flask-app:latest
[ec2-user@ip-172-31-42-60 python_docker]$ docker images
REPOSITORY                                                TAG       IMAGE ID       CREATED             SIZE
709524548272.dkr.ecr.ap-south-1.amazonaws.com/flask-app   latest    48f20ef0b7a6   17 minutes ago      1.03GB
deba2110/flask-app                                        latest    48f20ef0b7a6   17 minutes ago      1.03GB
flask-app                                                 latest    48f20ef0b7a6   17 minutes ago      1.03GB
deba2110/test                                             latest    362518b5324c   About an hour ago   126MB
test                                                      latest    362518b5324c   About an hour ago   126MB
[ec2-user@ip-172-31-42-60 python_docker]$ docker push 709524548272.dkr.ecr.ap-south-1.amazonaws.com/flask-app:latest
The push refers to repository [709524548272.dkr.ecr.ap-south-1.amazonaws.com/flask-app]
5573394360b4: Pushed
5f70bf18a086: Pushed
a512b4c86049: Pushed
e9b3f3afe636: Pushed
09418520a5f8: Pushed
68405a3b48ff: Pushed
6c7c1b88da61: Pushed
b2bcbd8ebb2b: Pushed
7f0053786e6e: Pushed
f7f2b929d8a5: Pushed
latest: digest: sha256:b195dc1d15327514f0471127af0824478d8696b82eb43ffb50920175f63f5417 size: 2421
[ec2-user@ip-172-31-42-60 python_docker]$

